[
    {
        "fingerprints": {
            "matchBasedId/v1": "884f5b8ffc69ece0d9db58e62c72a495f821402384b4094f97b0e560ee437c65ea44cafb7ccb97f3b7b7a608f31f2a56aa49238e4cb60226b4942a9558eaa222_0"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-parsers/tika-parsers-standard/tika-parsers-standard-modules/tika-parser-text-module/src/main/java/org/apache/tika/parser/strings/StringsParser.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 52,
                        "endLine": 194,
                        "snippet": {
                            "text": "        ProcessBuilder pb = new ProcessBuilder(cmd);"
                        },
                        "startColumn": 29,
                        "startLine": 194
                    }
                }
            }
        ],
        "message": {
            "text": "A formatted or concatenated string was detected as input to a ProcessBuilder call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized."
        },
        "properties": {},
        "ruleId": "java.lang.security.audit.command-injection-process-builder.command-injection-process-builder",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! The cmd object is constructed from internal logic, and in most cases it is created using default values."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "c372db71de827fe4be2e6df4131326acfb2532c3382308512f4fe51fe52371dd29e0007156cb75c86bfeb659b2c12be94ab1527e4e99d3dd0136c4c80a5759cd_0"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-translate/src/main/java/org/apache/tika/language/translate/impl/MarianTranslator.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 64,
                        "endLine": 246,
                        "snippet": {
                            "text": "            postProcess.command(script, file.getAbsolutePath());"
                        },
                        "startColumn": 13,
                        "startLine": 246
                    }
                }
            }
        ],
        "message": {
            "text": "A formatted or concatenated string was detected as input to a ProcessBuilder call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized."
        },
        "properties": {},
        "ruleId": "java.lang.security.audit.command-injection-process-builder.command-injection-process-builder",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! Semgrep do not recognized that the script is created from internal logic and configs, and the file name is randomly generated by the code itself."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "bfcd44ea608ae180cd33e5a4273bb1fb99210fcf01b8d29b95e14baa554ebdd7468e790cb4ba179bc8dc177637a6894b397411b14625d8752769425b92e90443_2"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-core/src/main/java/org/apache/tika/embedder/ExternalEmbedder.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 80,
                        "endLine": 404,
                        "snippet": {
                            "text": "            process = Runtime.getRuntime().exec(cmd.toArray(String[]::new)[0]);"
                        },
                        "startColumn": 13,
                        "startLine": 404
                    }
                }
            }
        ],
        "message": {
            "text": "User controlled strings in exec() will result in command execution."
        },
        "properties": {},
        "ruleId": "mobsf.mobsfscan.injection.command_injection.command_injection",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! Semgrep do not find the command arguments are never called in this project, thus the cmd is created from internal logic."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "bfcd44ea608ae180cd33e5a4273bb1fb99210fcf01b8d29b95e14baa554ebdd7468e790cb4ba179bc8dc177637a6894b397411b14625d8752769425b92e90443_1"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-core/src/main/java/org/apache/tika/embedder/ExternalEmbedder.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 63,
                        "endLine": 133,
                        "snippet": {
                            "text": "                process = Runtime.getRuntime().exec(checkCmd);"
                        },
                        "startColumn": 17,
                        "startLine": 133
                    }
                }
            }
        ],
        "message": {
            "text": "User controlled strings in exec() will result in command execution."
        },
        "properties": {},
        "ruleId": "mobsf.mobsfscan.injection.command_injection.command_injection",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! Semgrep do not find the check method is never called in this project, thus the checkCmd will not sink by users' input."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "ee4fb40cba95a37899c761b2ae78ec0de1b6830b037b8843f74074666ef61f46d1fed18ec9046a6269ad2193d4b310e364d02a08201f6fda815afdb0a324be4b_0"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-core/src/main/java/org/apache/tika/detect/FileCommandDetector.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 58,
                        "endLine": 124,
                        "snippet": {
                            "text": "        ProcessBuilder builder = new ProcessBuilder(args);"
                        },
                        "startColumn": 34,
                        "startLine": 124
                    }
                }
            }
        ],
        "message": {
            "text": "A formatted or concatenated string was detected as input to a ProcessBuilder call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized."
        },
        "properties": {},
        "ruleId": "java.lang.security.audit.command-injection-process-builder.command-injection-process-builder",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! Semgrep do not recognized that the input stream is created from internal logic, thus will not be sinked by user input."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "72293f1b3ab0edfb8170483fb4af9d8aa56a0dcd28e082806f790df92bac343c6d3a71b98ea703a11cba984af1e53a0cb693f62e73cebba89d946dd7ecf8a311_1"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 61,
                        "endLine": 312,
                        "snippet": {
                            "text": "                process = Runtime.getRuntime().exec(cmd[0]);"
                        },
                        "startColumn": 17,
                        "startLine": 312
                    }
                }
            }
        ],
        "message": {
            "text": "User controlled strings in exec() will result in command execution."
        },
        "properties": {},
        "ruleId": "mobsf.mobsfscan.injection.command_injection.command_injection",
        "is_human_confirmed_true": false,
        "reason": "Similarly, context is limited! The cmd object is constructed from internal logic, and in most cases it is created using default values."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "72293f1b3ab0edfb8170483fb4af9d8aa56a0dcd28e082806f790df92bac343c6d3a71b98ea703a11cba984af1e53a0cb693f62e73cebba89d946dd7ecf8a311_2"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-core/src/main/java/org/apache/tika/parser/external/ExternalParser.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 58,
                        "endLine": 314,
                        "snippet": {
                            "text": "                process = Runtime.getRuntime().exec(cmd);"
                        },
                        "startColumn": 17,
                        "startLine": 314
                    }
                }
            }
        ],
        "message": {
            "text": "User controlled strings in exec() will result in command execution."
        },
        "properties": {},
        "ruleId": "mobsf.mobsfscan.injection.command_injection.command_injection",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! Semgrep do not recognized that the cmd is created from internal logic and will not be sinked by user input."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "e716cdc727025d2e09c24cf385f6bc3570704bf64b07051f428a18acfbea0c801b9048ba22beb9cb0ba4701a85aecdec1279cd0ff5b7f4f2824f63aa98a95818_1"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-translate/src/main/java/org/apache/tika/language/translate/impl/ExternalTranslator.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 77,
                        "endLine": 67,
                        "snippet": {
                            "text": "            Process process = Runtime.getRuntime().exec(checkCommandString);"
                        },
                        "startColumn": 13,
                        "startLine": 67
                    }
                }
            }
        ],
        "message": {
            "text": "User controlled strings in exec() will result in command execution."
        },
        "properties": {},
        "ruleId": "mobsf.mobsfscan.injection.command_injection.command_injection",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! The checkcmd is created from internal config files and hard coded `java -jar` string, thus will not be sinked by user input."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "2c0c96e4f07672a9acdea3a82ecc3d612d9178659f2d10ad71551c2ba332a3faa22dda3d3238825340f660db46de4400a8b0775a642c759813a7a1b99c4a1ef7_0"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-core/src/main/java/org/apache/tika/parser/external2/ExternalParser.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 82,
                        "endLine": 130,
                        "snippet": {
                            "text": "                result = ProcessUtils.execute(new ProcessBuilder(thisCommandLine),"
                        },
                        "startColumn": 47,
                        "startLine": 130
                    }
                }
            }
        ],
        "message": {
            "text": "A formatted or concatenated string was detected as input to a ProcessBuilder call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized."
        },
        "properties": {},
        "ruleId": "java.lang.security.audit.command-injection-process-builder.command-injection-process-builder",
        "is_human_confirmed_true": false,
        "reason": "Similarly, Semgrep do not find that this method is never called in this project, thus the command line is created from internal logic."
    },
    {
        "fingerprints": {
            "matchBasedId/v1": "d1e84749704a52249030ec8591ee6b6fcc3ba8079f7e46536d2e6070869174f016ba0931ff62f3c1db57b283532c4d0f050d9b4e6e0cacd9a90b84a8e89220d0_0"
        },
        "locations": [
            {
                "physicalLocation": {
                    "artifactLocation": {
                        "uri": "/data/jiangjiajun/LLM4Security/data/projects/tika/tika-server/tika-server-core/src/main/java/org/apache/tika/server/core/TikaServerWatchDog.java",
                        "uriBaseId": "%SRCROOT%"
                    },
                    "region": {
                        "endColumn": 37,
                        "endLine": 413,
                        "snippet": {
                            "text": "            builder.command(argList);"
                        },
                        "startColumn": 13,
                        "startLine": 413
                    }
                }
            }
        ],
        "message": {
            "text": "A formatted or concatenated string was detected as input to a ProcessBuilder call. This is dangerous if a variable is controlled by user input and could result in a command injection. Ensure your variables are not controlled by users or sufficiently sanitized."
        },
        "properties": {},
        "ruleId": "java.lang.security.audit.command-injection-process-builder.command-injection-process-builder",
        "is_human_confirmed_true": false,
        "reason": "Context is limited! Semgrep do not understand that this command is created from internal configs, thus the argList will not sink by users' input."
    }
]